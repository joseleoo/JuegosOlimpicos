select  p.Descripcion as Pais, Nombre, coalesce( (select max(peso) from Registros where DeportistaId=d.Id and TipoPruebaId=1 ),0) as ARRANQUE,coalesce( (select max(peso) from Registros where DeportistaId=d.Id and TipoPruebaId=2 ),0) as ENVION,coalesce((select max(peso) from Registros where DeportistaId=d.Id and TipoPruebaId=2 ),0)+ coalesce( (select max(peso) from Registros where DeportistaId=d.Id and TipoPruebaId=1 ),0) AS Total from Deportistas d inner join Paises p on  p.Id=d.PaisId order by Total desc